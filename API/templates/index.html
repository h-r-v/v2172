<html>
<head>

</head>
<body>
    <div class="container">
        <div class="row">
            <div class="feed">
                <h3 class="mt-5">Live Streaming</h3>
                <img src="{{ url_for('video_feed') }}" width="100%">
            </div>
            <br>
            <div class="motion_control">
                <p>buttons here</p>
                <button type="submit"  id="mUP" onclick=holdit(up,upAPI(),1000,2)>Front</button>
                <button type="submit" id="mDown" onclick=holdit(down,downAPI(),1000,2)>Back</button>
                <button type="submit" id="mLeft" onclick=holdit(left,leftAPI(),1000,2)>Left</button>
                <button type="submit" id="mRight" onclick=holdit(right,rightAPI(),1000,2)>Right</button>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var up = document.getElementById('mUP');
        var down = document.getElementById('mDown');
        var left = document.getElementById('mLeft');
        var right = document.getElementById('mRight');

        function holdit(btn, action, start, speedup) {
    var t;
    var repeat = function () {
        action();
        t = setTimeout(repeat, start);
        start = start / speedup;
    }
    btn.mousedown = function() {
        repeat();
    }
    btn.mouseup = function () {
        clearTimeout(t);
    }
};
    
    function upAPI(){
        fetch('http://localhost:5000/up')
  .then(response => response.json())
  .then(data => console.log(data));
    }

    function downAPI(){
        fetch('http://localhost:5000/down')
  .then(response => response.json())
  .then(data => console.log(data));
    }

    function leftAPI(){
        fetch('http://localhost:5000/left')
  .then(response => response.json())
  .then(data => console.log(data));
    }

    function rightAPI(){
        fetch('http://localhost:5000/right')
  .then(response => response.json())
  .then(data => console.log(data));
    }
    </script>
    </body>
</html>